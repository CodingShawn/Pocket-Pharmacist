{"version":3,"sources":["utils/utils.js","components/DisplayResults.js","components/Loading.js","components/SearchForm.js","components/Header.js","components/Footer.js","services/therapeuticProductsListing.js","App.js","index.js"],"names":["parserUtils","seperateComponents","string","replace","parseString","replaceAmpersand","toUpperCase","DisplayResults","results","searchTerm","parsedRows","map","result","index","id","row","Object","keys","forEach","key","title","data","columns","name","label","options","display","resizableColumns","filter","rowsPerPage","rowsPerPageOptions","responsive","selectableRows","textLabels","body","noMatch","Loading","useState","rotation","setRotation","updateRotation","timer","setTimeout","clearTimer","clearTimeout","useEffect","targetClass","document","getElementById","style","transform","rotateHourGlass","color","padding","SearchForm","setResults","setSearchTerm","isLoading","drugName","setDrugName","hasSearched","setHasSearched","saveResultsToState","record","active_ingredients","includes","product_name","onSubmit","event","preventDefault","TextField","type","onChange","target","value","autoFocus","required","IconButton","Header","Footer","d","Date","todayDate","getDate","getMonth","getFullYear","attribution","href","BASE_URL","therapeuticProductsListingService","searchViaField","searchField","a","request","params","q","axios","get","response","records","getDrug","searchViaProductName","searchViaActiveIngredient","concat","getAllDrugs","limit","App","setData","setIsLoading","drugs","formattedData","formatData","drug","field","setDrugData","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.cdc94972.chunk.js","sourcesContent":["// API returns JSON in following format: {\r\n//   \"_id\": 4791,\r\n//   \"license_holder\": \"\\\"GALDERMA SINGAPORE PRIVATE LIMITED\\\"\",\r\n//   \"atc_code\": \"D10AD53\",\r\n//   \"approval_date\": \"21/4/2010\",\r\n//   \"rank\": 0,\r\n//   \"forensic_classification\": \"Prescription Only\",\r\n//   \"active_ingredients\": \"\\\"Adapalene&&Benzoyl peroxide\\\"\",\r\n//   \"strength\": \"\\\"0.10%&&2.50%\\\"\",\r\n//   \"_full_count\": \"5\",\r\n//   \"country_of_manufacturer\": \"\\\"FRANCE\\\"\",\r\n//   \"route_of_administration\": \"TOPICAL\",\r\n//   \"licence_no\": \"SIN13789P\",\r\n//   \"product_name\": \"\\\"EPIDUO GEL 0.1%/2.5%\\\"\",\r\n//   \"manufacturer\": \"\\\"LABORATOIRES GALDERMA\\\"\",\r\n//   \"dosage_form\": \"\\\"GEL\\\"\"\r\n// }\r\n// Need to parse strings accordingly\r\n\r\n// Removed following function as dataset now returns queries without quotations\r\n// function removeQuotations(string) {\r\n//   // As quotations are always the first and last char, to simply remove those chars - outdated comment\r\n//   return string.substring(1, string.length - 1);\r\n// }\r\n\r\nfunction replaceAmpersand(string) {\r\n  return string.replace(/&&/g, \", \");\r\n}\r\n\r\nfunction parseString(string) {\r\n  return replaceAmpersand(string).toUpperCase();\r\n}\r\n\r\nexport function seperateComponents(string) {\r\n  return string.replace(/,/g, \"\\n\");\r\n}\r\n\r\nconst parserUtils = { seperateComponents, parseString };\r\n\r\n// For testing with jest\r\n// module.exports = {\r\n//   removeQuotations,\r\n//   replaceAmpersand,\r\n//   parseString,\r\n//   seperateComponents,\r\n// };\r\n\r\nexport default parserUtils;\r\n","import MUIDataTable from \"mui-datatables\";\r\nimport parserUtils from \"../utils/utils\";\r\n\r\nfunction DisplayResults({ results, searchTerm }) {\r\n  const rows = results.map((result, index) => {\r\n    return { ...result, id: index };\r\n  });\r\n\r\n  const parsedRows = rows.map((row) => {\r\n    Object.keys(row).forEach(function (key) {\r\n      if (typeof row[key] === \"string\" && key !== \"forensic_classification\") {\r\n        row[key] = parserUtils.parseString(row[key]);\r\n        if (key === \"active_ingredients\" || key === \"strength\") {\r\n          // To clearly show individual components composition within product\r\n          row[key] = parserUtils.seperateComponents(row[key]);\r\n        }\r\n      }\r\n    });\r\n    return row;\r\n  });\r\n\r\n  const columns = [\r\n    {\r\n      name: \"product_name\",\r\n      label: \"Product Name\",\r\n    },\r\n    {\r\n      name: \"active_ingredients\",\r\n      label: \"Active Ingredients\",\r\n    },\r\n    {\r\n      name: \"strength\",\r\n      label: \"Strength\",\r\n    },\r\n    {\r\n      name: \"dosage_form\",\r\n      label: \"Dosage Form\",\r\n    },\r\n    {\r\n      name: \"forensic_classification\",\r\n      label: \"Forensic Classification\",\r\n      options: {\r\n        display: false,\r\n      },\r\n    },\r\n    {\r\n      name: \"manufacturer\",\r\n      label: \"Manufacturer\",\r\n      options: {\r\n        display: false,\r\n      },\r\n    },\r\n    {\r\n      name: \"country_of_manufacturer\",\r\n      label: \"Country of Manufacturer\",\r\n      options: {\r\n        display: false,\r\n      },\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <MUIDataTable\r\n      title={`Search Results for \"${searchTerm}\"`}\r\n      data={parsedRows}\r\n      columns={columns}\r\n      options={{\r\n        resizableColumns: true,\r\n        filter: false,\r\n        rowsPerPage: 20,\r\n        rowsPerPageOptions: [20, 50],\r\n        responsive: \"standard\",\r\n        selectableRows: \"none\",\r\n        textLabels: {\r\n          body: {\r\n            noMatch:\r\n              \"No records found. Please check if you have spelt the name correctly.\",\r\n          },\r\n        },\r\n      }}\r\n    />\r\n  );\r\n}\r\n\r\nexport default DisplayResults;\r\n","import { useEffect, useState } from \"react\";\r\nimport HourglassEmptyIcon from \"@material-ui/icons/HourglassEmpty\";\r\n\r\nfunction Loading() {\r\n  const [rotation, setRotation] = useState(0);\r\n\r\n  function rotateHourGlass() {\r\n    const targetClass = document.getElementById(\"rotating\");\r\n    if (targetClass) {\r\n      targetClass.style.transform = `rotate(${rotation}deg)`;\r\n    }\r\n  }\r\n\r\n  function updateRotation() {\r\n    rotation < 315 ? setRotation(rotation + 45) : setRotation(0);\r\n  }\r\n\r\n  function timer() {\r\n    setTimeout(updateRotation, 250);\r\n  }\r\n\r\n  function clearTimer() {\r\n    clearTimeout(timer);\r\n  }\r\n\r\n  useEffect(() => {\r\n    timer();\r\n    return clearTimer;\r\n  });\r\n\r\n  useEffect(() => {\r\n    rotateHourGlass();\r\n    // eslint-disable-next-line\r\n  }, [rotation]);\r\n\r\n  return (\r\n    <HourglassEmptyIcon id=\"rotating\" style={{ color: \"rgba(0,0,0,0.54)\", padding: \"12px\" }} />\r\n  );\r\n}\r\n\r\nexport default Loading;\r\n","import TextField from \"@material-ui/core/TextField\";\r\nimport SearchIcon from \"@material-ui/icons/Search\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Loading from \"../components/Loading\";\r\nimport { useState, useEffect } from \"react\";\r\n\r\nfunction SearchForm({ setResults, setSearchTerm, data, isLoading }) {\r\n  const [drugName, setDrugName] = useState(\"\");\r\n  const [hasSearched, setHasSearched] = useState(false);\r\n\r\n  function handleSubmit(event) {\r\n    event.preventDefault();\r\n    if (!isLoading) {\r\n      saveResultsToState();\r\n    }\r\n    setHasSearched(true);\r\n    setSearchTerm(drugName);\r\n  }\r\n\r\n  function saveResultsToState() {\r\n    let results = data.filter((record) => {\r\n      return (\r\n        record.active_ingredients.includes(drugName.toUpperCase()) ||\r\n        record.product_name.includes(drugName.toUpperCase())\r\n      );\r\n    });\r\n    setResults(results);\r\n  }\r\n\r\n  useEffect(() => {\r\n    if(hasSearched) {\r\n      saveResultsToState();\r\n    }\r\n    // eslint-disable-next-line\r\n  },[isLoading])\r\n\r\n  return (\r\n    <section>\r\n      <form onSubmit={handleSubmit} id=\"search-form\">\r\n        {!(isLoading && hasSearched) && (\r\n          <>\r\n            <TextField\r\n              label=\"Drug / Product Name\"\r\n              type=\"search\"\r\n              onChange={({ target }) => setDrugName(target.value)}\r\n              value={drugName}\r\n              autoFocus\r\n              required\r\n            />\r\n            <IconButton type=\"submit\">\r\n              <SearchIcon />\r\n            </IconButton>\r\n          </>\r\n        )}\r\n        {isLoading && hasSearched && <Loading />}\r\n      </form>\r\n    </section>\r\n  );\r\n}\r\n\r\nexport default SearchForm;\r\n","function Header() {\r\n  return (\r\n    <header>\r\n      <h1 id=\"header\">Pocket Pharmacist</h1>\r\n    </header>\r\n  );\r\n}\r\n\r\nexport default Header;\r\n","function Footer() {\r\n  const months = [\r\n    \"January\",\r\n    \"February\",\r\n    \"March\",\r\n    \"April\",\r\n    \"May\",\r\n    \"June\",\r\n    \"July\",\r\n    \"August\",\r\n    \"September\",\r\n    \"October\",\r\n    \"November\",\r\n    \"December\",\r\n  ];\r\n  const d = new Date();\r\n  let todayDate = `${d.getDate()} ${months[d.getMonth()]} ${d.getFullYear()}`;\r\n  let attribution = `* Contains information from Listing of Registered Therapeutic Products accessed on ${todayDate} from Health Sciences Authority which is made available under the terms of the`;\r\n\r\n  return (\r\n    <footer id=\"footer\">\r\n      <div>\r\n        {attribution}{\" \"}\r\n        <a href=\"https://data.gov.sg/open-data-licence\">\r\n          Singapore Open Data Licence version 1.0\r\n        </a>\r\n      </div>\r\n      <div>\r\n        ** Data retrieved may be outdated. Refer to{\" \"}\r\n        <a href=\"http://eservice.hsa.gov.sg/prism/common/enquirepublic/SearchDRBProduct.do?action=load\">\r\n          HSA website\r\n        </a>{\" \"}\r\n        for latest list of health products\r\n      </div>\r\n    </footer>\r\n  );\r\n}\r\n\r\nexport default Footer;\r\n","import axios from \"axios\";\r\n\r\nconst BASE_URL =\r\n  \"https://data.gov.sg/api/action/datastore_search?resource_id=3ee20559-372d-42f0-bde9-245e21f7f39b\";\r\n\r\nconst therapeuticProductsListingService = {};\r\n\r\ntherapeuticProductsListingService.getDrug = async function getDrug(searchTerm) {\r\n  const searchViaProductName = await searchViaField(\"product_name\", searchTerm);\r\n  const searchViaActiveIngredient = await searchViaField(\r\n    \"active_ingredients\",\r\n    searchTerm\r\n  );\r\n  const response = searchViaActiveIngredient.concat(searchViaProductName);\r\n  return response;\r\n};\r\n\r\ntherapeuticProductsListingService.getAllDrugs = async function getAllDrugs() {\r\n  const request = {\r\n    // Default download is 100, set to 100000 to ensure all records downloaded\r\n    // 5621 products registered as of August 2021\r\n    params: {\r\n      limit: 100000,\r\n    },\r\n  };\r\n  const response = await axios.get(BASE_URL, request);\r\n  const { records } = response.data.result;\r\n  return records;\r\n}\r\n\r\nasync function searchViaField(searchField, searchTerm) {\r\n  const request = {\r\n    params: {\r\n      q: { [searchField]: searchTerm },\r\n    },\r\n  };\r\n  const response = await axios.get(BASE_URL, request);\r\n  const { records } = response.data.result;\r\n  return records;\r\n}\r\n\r\nexport default therapeuticProductsListingService;\r\n","import { useState, useEffect } from \"react\";\r\nimport DisplayResults from \"./components/DisplayResults\";\r\nimport SearchForm from \"./components/SearchForm\";\r\nimport Header from \"./components/Header\";\r\nimport Footer from \"./components/Footer\";\r\nimport \"./components.css\";\r\nimport therapeuticProductsListingService from \"./services/therapeuticProductsListing\";\r\n\r\nfunction App() {\r\n  const [results, setResults] = useState(null);\r\n  const [searchTerm, setSearchTerm] = useState(\"\");\r\n  const [data, setData] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    setDrugData();\r\n    // eslint-disable-next-line\r\n  }, []);\r\n\r\n  async function setDrugData() {\r\n    const drugs = await therapeuticProductsListingService.getAllDrugs();\r\n    const formattedData = formatData(drugs);\r\n    setData(formattedData);\r\n    setIsLoading(false);\r\n  }\r\n\r\n  function formatData(drugs) {\r\n    let formattedData = drugs.map((drug) => {\r\n      for (let field in drug) {\r\n        if (typeof drug[field] === \"string\") {\r\n          drug[field] = drug[field].toUpperCase();\r\n        }\r\n      }\r\n      return drug;\r\n    });\r\n    return formattedData;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Header />\r\n      <SearchForm\r\n        setResults={setResults}\r\n        setSearchTerm={setSearchTerm}\r\n        data={data}\r\n        isLoading={isLoading}\r\n      />\r\n      {results && <DisplayResults results={results} searchTerm={searchTerm} />}\r\n      <Footer />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);"],"sourceRoot":""}